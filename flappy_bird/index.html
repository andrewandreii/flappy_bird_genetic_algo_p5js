<!DOCTYPE html>
<html lang="">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>p5.js example</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <style>
        :root {
            --bg-dark: #1f2335;
            --bg: #24283b;
            --bg-highlight: #292e42;
            --blue1: #2ac3de;
            --blue2: #0db9d7;
            --blue5: #89ddff;
            --blue6: #b4f9f8;
            --blue7: #394b70;
            --fg: #c0caf5;
            --fg-dark: #a9b1d6;
        }

        html,
        body {
            height: 100%;
        }

        body {
            margin: 0;
            display: flex;
            flex-direction: row;
            background: var(--bg-dark);
            justify-content: center;
            align-items: center;
        }

        canvas {
            border-radius: 1%;
            margin-bottom: 10px;
        }

        #main-div {
            margin: 0;
            display: flex;
            margin-right: 10px;
            margin-left: 10px;
            height: 90%;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #controls {
            margin: 0;
            border-radius: 1%;
            background-color: var(--bg);
            grid-template-columns: auto auto;
            margin-top: 10px;
            flex-grow: 1;
            width: 100%;
            display: grid;
            gap: 10px;
            align-items: center;
            justify-content: space-around;
        }

        #docs {
            height: 90%;
            width: 50%;
            border-radius: 1%;
            margin-left: 10px;
            margin-right: 10px;
            background: var(--bg);
            overflow-y: scroll;
            padding: 10px;
            color: var(--fg);
        }

        button {
            padding: 10px;
            overflow: hidden;
            min-width: 0;
            min-height: 0;
            border-radius: 5px;
            background-color: var(--bg-highlight);
            color: var(--fg);
            border: none;
        }

        button:hover {
            background-color: var(--fg-dark);
        }

        span {
            display: flex;
            gap: 10px;
            justify-content: space-between;
            color: var(--fg);
        }
    </style>
    <script src="../p5.min.js"></script>
    <script src="../neural_network/matrix.js"></script>
    <script src="../neural_network/nn.js"></script>
    <script src="sketch.js"></script>
    <script src="util.js"></script>
    <script src="ga.js"></script>
    <script src="bird.js"></script>
    <script src="pipes.js"></script>
</head>

<body>
    <div id="main-div">
        <main>
        </main>
        <div id="controls">
            <span>
                Population size:
                <input id="populationSize" type="range" min="30" max="700" step="10" class="form-range">
            </span>
            <button id="pauseButton">Pause</button>
            <span>
                Bird jump height (when reset):
                <input id="birdLift" type="range" min="2" max="10" step="1" class="form-range">
            </span>
            <button id="resetButton">Reset</button>
        </div>
    </div>
    <div id="docs">
        <h1>Flappy Bird Genetic Algorithm</h1>
        <br>
        <h2>The differences from the original idea by Daniel Shiffman</h2>
        1) The <b>mutation function</b>. In contrast with the original code, this one allows a bird to have two parents from a previous generation, mixing their genetic code up. This allows us to make broaden our <b>search space</b>.
        <br>
        2) This flappy bird algorithm also <b>preserves the best performing individual</b> of all time alive so that we don't lose its good genes. This is called <b>elitist selection</b>.
        <br>
        3) The <b>jump height</b> also differs by default (but there is a slider available to modify it). This might result in performance differences between the two algorithms.
        <br>
        4) You may also notice that the <b>terrain gets increasingly more difficult</b>, starting off with easy spacious pipes and getting more cramped as the algorithm performs better. This feature was added so that the birds can learn at a steady pace (instead of making it hard from the beginning and waiting a long time for it to pass the first 2 pipes).
        <br>
        5) The birds can now <b>die if they fly too low or too high</b>. I noticed that birds that aren't that fit make it to the next generation just by <i>being alive</i> because they don't die until the first pipe. This method hopefully reduces the bad genes in the gene pool.
        <br>
        <br>
        <h3>How is the fitness of a bird calculated?</h3>
        <br>
        We use a `score` variable in the `Bird` class that represents how many frames a bird has lived. Each bird is assigned the percentage of their score in the whole population.
        <br>
        <br>
        <h3>How do we pick the parents?</h3>
        <br>
        Each fitness represents the chances a bird has to be picked. We do it this way so that there is variety in the next generation (i.e. the not-so-good birds also get a chance to have a child).
        <br>
        <br>
        <h3>How does the mutation function work?</h3>
        <br>
        Each weight and bias of the neural network of a bird is tweaked by a small random amount (or has a chance of remaining the same).
        <br>
        <br>
        <h3>What do the colors of the birds represent?</h3>
        <br>
        At the beginning of the simulation each of the birds is assigned a color. The next generations, the colors of two parents get mixed to produce the color of their child. By the end (when the birds are basically as good as they can get at the game) there will probably be one color that remains standing since siblings are likely to be parents.
        <br>
        <br>
        <h3>Resources Used:</h3>
        <br>
        The cloud sprites used for the pipes: https://thehibiscuspoet.itch.io/
        <br>
        The images used for the background: https://free-game-assets.itch.io/
    </div>
</body>

</html>